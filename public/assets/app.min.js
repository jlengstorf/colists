webpackJsonp([0],[function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n(2);var i=n(6),o=r(i);setTimeout(function(){o["default"].initialize()},1500)},function(e,t,n){var r=n(3);"string"==typeof r&&(r=[[e.id,r,""]]);n(5)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(4)(),t.push([e.id,"@import url(https://fonts.googleapis.com/css?family=Rock+Salt|Open+Sans:400,400italic);",""]),t.push([e.id,"*{box-sizing:border-box;margin:0}*+*{margin-top:16px;margin-top:1rem}.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(1px,1px,1px,1px);border:0}body{padding:1em;background-color:#fdfcf9;color:#6c5d62;font-family:Open Sans,sans-serif}.app,.footer,.header{display:block;max-width:520px;margin-left:auto;margin-right:auto}.header__list-name{color:#5c4b51;font-family:Rock Salt,cursive;font-size:32px;font-size:2rem;line-height:2;text-align:center;text-rendering:optimizeLegibility;text-shadow:2px 2px 0 #f2ebbf}.create{padding:16px;padding:1rem;background:#f3b562;border-radius:.5rem}.create__input{width:100%;margin:0;padding:12px 16px;padding:.75rem 1rem;border:1px solid #e7ac5d;border-radius:.5rem;font-size:26px;font-size:1.625rem}.items{margin-top:32px;margin-top:2rem}.items__list{position:relative;z-index:1;min-height:48px;min-height:3rem;padding:0;list-style:none}.items__list--loading:after,.items__list--loading:before{content:'';position:absolute;top:50%;left:50%;width:16px;width:1rem;height:16px;height:1rem;-webkit-animation:1.2s infinite a ease-in-out;animation:1.2s infinite a ease-in-out;background-color:transparent;border:1px solid transparent;border-radius:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);z-index:2}.items__list--loading:before{-webkit-animation-delay:.6s;animation-delay:.6s}.items__list--loading .items__item{display:none}.items__list:not(.items__list--loading):empty:before{content:'There are no items in your list. Add one above!';position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:#aea5a8;font-size:12px;font-size:.75rem;font-style:italic}@-webkit-keyframes a{0%{width:.125rem;height:.125rem;background-color:#8ceeb2;background-color:rgba(140,238,178,.75);border-color:rgba(243,181,98,.5)}0%,to{border-color:#f3b562}to{width:2rem;height:2rem;background-color:rgba(140,238,178,0);border-color:rgba(243,181,98,.05)}}@keyframes a{0%{width:.125rem;height:.125rem;background-color:#8ceeb2;background-color:rgba(140,238,178,.75);border-color:rgba(243,181,98,.5)}0%,to{border-color:#f3b562}to{width:2rem;height:2rem;background-color:rgba(140,238,178,0);border-color:rgba(243,181,98,.05)}}.item{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;height:56px;height:3.5rem;margin:0;padding:0;overflow:hidden;-webkit-transform:scaleY(1);transform:scaleY(1);-webkit-transform-origin:top;transform-origin:top;-webkit-transition:.2s all linear;transition:.2s all linear}.item__complete,.item__delete,.item__text{margin-top:0}.item__text{-webkit-box-flex:20;-webkit-flex:20;-ms-flex:20;flex:20;-webkit-box-ordinal-group:3;-webkit-order:2;-ms-flex-order:2;order:2;min-width:80%;margin:4px 0;margin:.25rem 0;padding:16px;padding:1rem;background-color:#efedee;border-radius:.5rem;overflow:hidden;text-overflow:ellipsis;white-space:pre;-webkit-transition:.1s all linear;transition:.1s all linear}.item__text:after,.item__text:before{content:'';position:absolute;bottom:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);-webkit-transition:.2s all linear;transition:.2s all linear;background:#5c4b51;border:1px solid #534449;opacity:0;pointer-events:none}.item__text:before{content:'TIP: Double-click an item to edit.';padding:8px;padding:.5rem;border-radius:.5rem;color:#fdfcf9;font-size:8px;font-size:.5rem}.item__text:after{width:4px;width:.25rem;height:4px;height:.25rem;border-top:0;border-left:0;-webkit-transform:translate(-50%,.125rem) rotate(45deg);transform:translate(-50%,.125rem) rotate(45deg)}.item__text:hover:after,.item__text:hover:before{opacity:1;bottom:110%}.item__complete,.item__delete{-webkit-flex:1 16px;-ms-flex:1 16px;flex:1 16px;-webkit-box-flex:1;-webkit-flex:1 1rem;-ms-flex:1 1rem;flex:1 1rem;position:relative;width:16px;width:1rem;height:16px;height:1rem;background:none;border:none;text-indent:-9999px}.item__complete:after,.item__delete:after{position:absolute;top:0;left:0;width:100%;height:100%;color:#5c4b51;cursor:pointer;font-size:16px;font-size:1rem;line-height:1;text-align:center;text-indent:0;-webkit-transition:.2s all linear;transition:.2s all linear}.item__complete:focus,.item__complete:hover,.item__delete:focus,.item__delete:hover{outline:0}.item__complete:focus:after,.item__complete:hover:after,.item__delete:focus:after,.item__delete:hover:after{color:#f06060}.item__complete{-webkit-box-ordinal-group:2;-webkit-order:1;-ms-flex-order:1;order:1}.item__complete:after{content:'\\2610'}.item__delete{-webkit-box-ordinal-group:4;-webkit-order:3;-ms-flex-order:3;order:3}.item__delete:after{content:'\\D7'}.item--completed{opacity:.5}.item--completed .item__text{color:#aea5a8}.item--completed .item__complete:after{content:'\\2611'}.item--edit-in-progress>*{filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns=\"http://www.w3.org/2000/svg\"><filter id=\"filter\"><feGaussianBlur stdDeviation=\"2\" /></filter></svg>#filter');-webkit-filter:blur(2px);filter:blur(2px)}.item--edit-in-progress .item__text{opacity:.25}.item--edit-in-progress:after{content:'This item is being edited.';position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:12px;font-size:.75rem}.item--hidden{height:0;opacity:0;-webkit-transform:scaleY(0);transform:scaleY(0)}.footer{margin-top:32px;margin-top:2rem;padding:16px;padding:1rem;border-top:1px solid #d6d2d4}.footer__credits{color:#beb7b9;font-size:8px;font-size:.5rem;letter-spacing:2px;letter-spacing:.125rem;line-height:1;text-align:center;text-transform:uppercase}.footer__credit-link{color:inherit;text-decoration:none}.footer__credit-link:hover{text-decoration:underline}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=p[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(l(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(l(r.parts[o],t));p[r.id]={id:r.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],u=i[3],l={css:a,media:s,sourceMap:u};n[o]?n[o].parts.push(l):t.push(n[o]={id:o,parts:[l]})}return t}function o(e,t){var n=g(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function l(e,t){var n,r,i;if(t.singleton){var o=v++;n=_||(_=s(t)),r=c.bind(null,n,o,!1),i=c.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(t),r=d.bind(null,n),i=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=f.bind(null,n),i=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function c(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function f(e,t){var n=t.css,r=t.media;t.sourceMap;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=(t.media,t.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var p={},m=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=m(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=m(function(){return document.head||document.getElementsByTagName("head")[0]}),_=null,v=0,b=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=i(e);return r(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a],u=p[s.id];u.refs--,o.push(u)}if(e){var l=i(e);r(l,t)}for(var a=0;a<o.length;a++){var u=o[a];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete p[u.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){window.history.pushState({title:t},t,e)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),u=r(s),l=n(8),c=n(16),f=r(c),d=n(74),p=(r(d),n(76)),m=(r(p),n(9)),h=r(m),g=new h["default"]("blocks/app"),_=function(){function e(){i(this,e),f["default"].peerOn(u["default"].SERVER_ITEM_PEER_IS_EDITING,function(e){var t=e.itemID;(0,l.dispatch)({type:u["default"].SERVER_ITEM_PEER_IS_EDITING,itemID:t})})}return a(e,[{key:"initialize",value:function(){var e=this;this.getListID().then(function(t){e.listID=t,(0,l.dispatch)({type:u["default"].APP_INITIALIZE,listID:e.listID})})["catch"](g.error.bind(g))}},{key:"getListID",value:function(){return new Promise(function(e,t){if(window.location.pathname.length>1){var n=window.location.pathname.slice(1);n?e(n):t(Error("The list ID is empty."))}else{var r=window.prompt("Choose a name for your list:");f["default"].createList(r).then(function(t){o(t.get("id"),t.get("name")),e(t.get("id"))})["catch"](g.error.bind(g))}})}}]),e}(),v=new _;t["default"]=v},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={APP_INITIALIZE:"APP_INITIALIZE",STORE_UPDATED:"STORE_UPDATED",LIST_HIDE_LOADING_STATUS:"LIST_HIDE_LOADING_STATUS",ITEM_MARK_COMPLETE:"ITEM_MARK_COMPLETE",ITEM_DELETE:"ITEM_DELETE",ITEM_USER_IS_EDITING:"ITEM_USER_IS_EDITING",SERVER_JOIN_ROOM:"SERVER_JOIN_ROOM",SERVER_LIST_LOADED:"SERVER_LIST_LOADED",SERVER_LIST_NOT_FOUND:"SERVER_LIST_NOT_FOUND",SERVER_LIST_INITIAL_LOAD:"SERVER_LIST_INITIAL_LOAD",SERVER_LIST_USER_UPDATED:"SERVER_LIST_USER_UPDATED",SERVER_LIST_PEER_UPDATED:"SERVER_LIST_PEER_UPDATED",SERVER_ITEM_PEER_IS_EDITING:"SERVER_ITEM_PEER_IS_EDITING"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.dispatch=void 0;var a=n(9),s=r(a),u=new s["default"]("dispatcher"),l=[],c=[],f=!1,d=function(){function e(){i(this,e)}return o(e,[{key:"dispatch",value:function(e){u.log(e),this._addDispatchToQueue(e),this._sendDispatch()}},{key:"_addDispatchToQueue",value:function(e){c.push(e)}},{key:"_sendDispatch",value:function(){var e=this;this.isDispatching()||(c.length>0?!function(){f=!0;var t=c.shift();l.forEach(function(e){e(t)}),f=!1,e._sendDispatch()}():u.log("All dispatches sent."))}},{key:"isDispatching",value:function(){return f}},{key:"register",value:function(e){l.push(e)}}]),e}(),p=new d;t["default"]=p;t.dispatch=p.dispatch.bind(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=r(a),u=n(13),l=r(u),c=function(){function e(t){i(this,e),this.__debug=s["default"].debug?(0,l["default"])(t):function(){}}return o(e,[{key:"log",value:function(){this.__debug.apply(this,arguments)}},{key:"maybeLog",value:function(e){if(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];this.__debug.apply(this,n)}}},{key:"error",value:function(){this.__debug.apply(this,arguments)}}]),e}();t["default"]=c},function(e,t,n){"use strict";var r=n(11);r.socket.url="https://colists.herokuapp.com/",e.exports=r},function(e,t,n){(function(t){"use strict";e.exports={animation:{timeout:210},classes:{item:"items__item item",editing:"item--edit-in-progress",hidden:"item--hidden",complete:"item--completed",text:"item__text",button:{complete:"item__complete","delete":"item__delete"}},database:{version:1,name:"colists"},debug:!0,socket:{url:"http://localhost:3001"},server:{host:t.env.HOST||"localhost",port:t.env.PORT||3001},mongodb:{uri:t.env.MONGOLAB_URI||"mongodb://localhost/colists"}}}).call(t,n(12))},function(e,t){function n(){l=!1,a.length?u=a.concat(u):c=-1,u.length&&r()}function r(){if(!l){var e=setTimeout(n);l=!0;for(var t=u.length;t;){for(a=u,u=[];++c<t;)a&&a[c].run();c=-1,t=u.length}a=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function o(){}var a,s=e.exports={},u=[],l=!1,c=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new i(e,t)),1!==u.length||l||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return new Promise(function(n,r){t||r(Error("A store name is required.")),e&&n(e);var i=indexedDB.open(d["default"].database.name,d["default"].database.version);i.onupgradeneeded=function(e){e.target.transaction.onerror=l,e.target.result.createObjectStore(t)},i.onsuccess=function(e){O=e.target.result,n(O)},i.onerror=r})}function u(e){return new Promise(function(t,n){s(O,k).then(e.bind(null,t,n))})}function l(e){T.error(e)}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var f=n(10),d=r(f),p=n(7),m=r(p),h=n(8),g=r(h),_=n(17),v=r(_),b=n(69),y=(r(b),n(70)),E=r(y),I=n(73),w=r(I),S=n(9),x=r(S),T=new x["default"]("stores/list"),k="lists",O=void 0,R=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.__notifyServerOnChange=!0,n.__serverEventName=m["default"].SERVER_LIST_USER_UPDATED,n.peerOn(m["default"].SERVER_LIST_PEER_UPDATED,n.updateList.bind(n)),n}return a(t,e),c(t,[{key:"reduce",value:function(e,t){switch(t.type){case m["default"].APP_INITIALIZE:this.getOrCreateList(t);break;case m["default"].ITEM_MARK_COMPLETE:this.toggleItemComplete(t.itemID);break;case m["default"].ITEM_DELETE:this.deleteItem(t.itemID);break;case m["default"].SERVER_LIST_PEER_UPDATED:this.updateList(t.list)}return e}},{key:"getListID",value:function(){return this.getState().get("id")}},{key:"getAllItems",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.sort,n=void 0===t?"complete":t,r=this.getState().get("items");return n&&r?r.sortBy(function(e){return e[n]}):r}},{key:"getOrCreateList",value:function(e){var t=this,n=e.listID,r=void 0===n?"none":n,i=e.listName,o=void 0===i?!1:i;return u(function(e,n,i){var a=i.transaction(k).objectStore(k),s=a.get(r);s.onerror=l,s.onsuccess=function(){var a=void 0;if(!s.result&&"none"!==r)return t.peerEmit(m["default"].SERVER_LIST_INITIAL_LOAD,{listID:r}),void T.log("Loading the list from the server...");if(s.result)a=new E["default"](s.result,!1);else{if(!o)return void n(Error("No list found, and no new list name provided!"));a=new E["default"]({name:o})}t._maybeSaveList(e,n,i,t.getState(),a),t.peerJoin(a.get("id"))}})}},{key:"createList",value:function(e){return this.getOrCreateList({listName:e})}},{key:"updateList",value:function(e){var t=this,n=new E["default"](e,!1);return u(function(){for(var e=arguments.length,r=Array(e),i=0;e>i;i++)r[i]=arguments[i];t._maybeSaveList.apply(t,r.concat([t.getState(),n]))})}},{key:"saveItem",value:function(e){var t=this;return u(function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var o=new w["default"](e),a=t.getState().setIn(["items",o.id],o).set("updated",o.updated);t._maybeSaveList.apply(t,r.concat([t.getState(),a]))})}},{key:"getItem",value:function(e){return this.getState().getIn(["items",e])}},{key:"toggleItemComplete",value:function(e){var t=this;return u(function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var o=Date.now(),a=t.getState().setIn(["items",e,"complete"],!t.getState().getIn(["items",e,"complete"])).setIn(["items",e,"updated"],o).set("updated",o);t._maybeSaveList.apply(t,r.concat([t.getState(),a]))})}},{key:"deleteItem",value:function(e){var t=this;return u(function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var o=t.getState().deleteIn(["items",e]).set("updated",Date.now());t._maybeSaveList.apply(t,r.concat([t.getState(),o]))})}},{key:"_maybeSaveList",value:function(e,t,n,r,i){var o=this;if(this._didChange(r,i)){this.__hasStateChanged=!0,this.replaceState(i);var a=n.transaction(k,"readwrite"),s=a.objectStore(k),u=s.put(this.getState().toJSON(),this.getState().get("id"));a.oncomplete=function(){o._notifyOnChange(),e(o.getState())},u.onerror=t}else e(this.getState())}},{key:"handlePeerListChange",value:function(e){dispatch({type:m["default"].SERVER_LIST_PEER_UPDATED,list:e})}}]),t}(v["default"]),D=new R(g["default"]);t["default"]=D},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(10),l=r(u),c=n(7),f=r(c),d=n(18),p=r(d),m=n(19),h=r(m),g=n(69),_=r(g),v=n(9),b=r(v),y=(0,h["default"])(l["default"].socket.url),E=new b["default"]("stores/base"),I=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this));return n.__state=n.getInitialState(),n.__hasStateChanged=!1,n.__notifyServerOnChange=!1,n.__serverEventName=!1,e.register(function(e){n._handleDispatch(e)}),n}return a(t,e),s(t,[{key:"getInitialState",value:function(){return _["default"].Map()}},{key:"getState",value:function(){return this.__state}},{key:"replaceState",value:function(e){this.__state=e}},{key:"reduce",value:function(e,t){E.error("The store must override the reduce method.")}},{key:"_handleDispatch",value:function(e){var t=this.__state,n=this.reduce(t,e);this._didChange(t,n)&&(this.__hasStateChanged=!0,this.replaceState(n)),this._notifyOnChange()}},{key:"_notifyOnChange",value:function(){this.__hasStateChanged===!0&&(this.emit(f["default"].STORE_UPDATED,null,!1),this.__notifyServerOnChange&&this.__serverEventName&&this.peerEmit(this.__serverEventName,this.getState().toJSON())),this.__hasStateChanged=!1}},{key:"_didChange",value:function(e,t){return!_["default"].is(e,t)}},{key:"peerJoin",value:function(e){console.log("SERVER_JOIN_ROOM",e),this.peerEmit(f["default"].SERVER_JOIN_ROOM,e)}},{key:"peerEmit",value:function(e,t){E.log("event fired: "+e),y.emit(e,t)}},{key:"peerOn",value:function(e,t){E.log("event handler for "+e),y.on(e,t)}}]),t}(p["default"]);t["default"]=I},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(69),a=r(o),s=n(71),u=n(73),l=r(u),c=function f(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.id,n=void 0===t?!1:t,r=e.name,o=void 0===r?!1:r,u=e.items,c=void 0===u?{}:u,d=e.updated,p=void 0===d?!1:d,m=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(i(this,f),!o)throw Error("Lists require a name.");var h={};return c&&Object.keys(c).forEach(function(e){h[String(c[e].id)]=new l["default"](c[e],!1)}),a["default"].fromJS({id:n||Date.now()+"-"+(0,s.safeSlug)(o),updated:!m&&p?p:Date.now(),name:(0,s.safeName)(o),items:h})};t["default"]=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeName=t.safeSlug=void 0;var r=n(72),i=(0,r.curry)(function(e){return e.toLowerCase()}),o=(0,r.curry)(function(e){return e.trim()}),a=(0,r.curry)(function(e,t,n){return n.replace(e,t)}),s=a(/[^A-z0-9\-+]/g),u=s("-"),l=s(" "),c=a(/[-]{2,}/g,"-"),f=a(/[\s]{2,}/g," "),d=a(/^-|-$/g,"");t.safeSlug=(0,r.compose)(i,d,c,u),t.safeName=(0,r.compose)(o,f,l)},function(e,t){"use strict";function n(e){return function t(){for(var n=this,r=arguments.length,i=Array(r),o=0;r>o;o++)i[o]=arguments[o];return i.length>=e.length?e.call.apply(e,[this].concat(i)):function(){for(var e=arguments.length,r=Array(e),o=0;e>o;o++)r[o]=arguments[o];return t.call.apply(t,[n].concat(i,r))}}}function r(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}Object.defineProperty(t,"__esModule",{value:!0}),t.curry=n,t.compose=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(69),s=(0,a.Record)({id:void 0,updated:void 0,text:void 0,complete:void 0}),u=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.id,o=void 0===n?!1:n,a=e.updated,s=void 0===a?!1:a,u=e.text,l=void 0===u?!1:u,c=e.complete,f=void 0===c?!1:c,d=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(r(this,t),!l)throw Error("Empty items are not allowed.");return i(this,Object.getPrototypeOf(t).call(this,{id:o||"item"+Date.now(),updated:!d&&s?s:Date.now(),text:l,complete:f}))}return o(t,e),t}(s);t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(t.preventDefault(),e.text.value.length<1)return!1;(0,l.dispatch)({type:u["default"].ITEM_USER_IS_EDITING,listID:p["default"].getListID(),itemID:!1});var n={id:e.id.value?e.id.value:null,text:e.text.value,complete:"true"===e.complete.value?!0:!1};p["default"].saveItem(n).then(function(){e.text.value="",e.id.value="",e.complete.value=""})}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),u=r(s),l=n(8),c=n(75),f=r(c),d=n(16),p=r(d),m=n(9),h=r(m),g=(new h["default"]("blocks/form"),function(){function e(){var t=this;i(this,e),this.$inputs={id:document.getElementById("itemId"),text:document.getElementById("itemText"),complete:document.getElementById("itemComplete")},document.body.addEventListener("submit",o.bind(null,this.$inputs)),f["default"].on(u["default"].STORE_UPDATED,function(){t.getItemToEdit()})}return a(e,[{key:"getItemToEdit",value:function(){var e=f["default"].getUserEditing();if(e){var t=p["default"].getItem(e);this.$inputs.text.value=t.text,this.$inputs.id.value=t.id,this.$inputs.complete.value=t.complete,this.$inputs.text.focus()}}}]),e}()),_=new g;t["default"]=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(69),l=r(u),c=n(7),f=r(c),d=n(8),p=r(d),m=n(17),h=r(m),g=n(9),_=r(g),v=(new _["default"]("stores/app"),function(e){function t(){return i(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"getInitialState",value:function(){return l["default"].fromJS({isListLoaded:!1,user:{isEditing:!1},peer:{isEditing:!1}})}},{key:"reduce",value:function(e,t){switch(t.type){case f["default"].LIST_HIDE_LOADING_STATUS:e=e.set("isListLoaded",!0);break;case f["default"].ITEM_USER_IS_EDITING:e=e.setIn(["user","isEditing"],t.itemID),this.peerEmit(f["default"].SERVER_ITEM_PEER_IS_EDITING,{listID:t.listID,itemID:t.itemID});break;case f["default"].SERVER_ITEM_PEER_IS_EDITING:e=e.setIn(["peer","isEditing"],t.itemID)}return e}},{key:"isUserEditing",value:function(e){return this.getUserEditing()===e}},{key:"isPeerEditing",value:function(e){return this.getPeerEditing()===e}},{key:"getUserEditing",value:function(){return this.getState().getIn(["user","isEditing"])}},{key:"getPeerEditing",value:function(){return this.getState().getIn(["peer","isEditing"])}}]),t}(h["default"])),b=new v(p["default"]);t["default"]=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=document.getElementById(t.id)||s(t),r=document.contains(n);if(r){n.querySelector("."+h["default"].classes.text).textContent=t.text;var i=n.classList.contains(h["default"].classes.complete);t.complete!==i&&l(n,a.bind(null,e))}var o=E["default"].isUserEditing(n.id),u=o||E["default"].isPeerEditing(n.id);c(u,n,h["default"].classes.editing),T.maybeLog(u,"Item#"+n.id+" is being edited."),c(t.complete,n,h["default"].classes.complete),r||a(e,n)}function a(e,t){t.classList.add(h["default"].classes.hidden),t.classList.contains(h["default"].classes.complete)?e.appendChild(t):e.insertBefore(t,e.querySelector("."+h["default"].classes.complete)),setTimeout(function(){return t.classList.remove(h["default"].classes.hidden)},h["default"].animation.timeout)}function s(e){var t=e.id,n=e.text,r=(e.complete,{listItem:{type:"li",text:null,className:h["default"].classes.item,id:t},itemText:{type:"span",text:n,className:h["default"].classes.text},completeBtn:{type:"button",text:"mark this item complete",className:h["default"].classes.button.complete},deleteBtn:{type:"button",text:"delete this item",className:h["default"].classes.button["delete"]}}),i=u(r.listItem),o=u(r.itemText),a=u(r.completeBtn),s=u(r.deleteBtn);return i.appendChild(o),i.appendChild(a),i.appendChild(s),i}function u(e){var t=e.type,n=e.text,r=e.className,i=void 0===r?"":r,o=e.id,a=void 0===o?!1:o,s=document.createElement(t);return s.textContent=n,s.className=i,s.id=a?a:null,s}function l(e,t){e.classList.add(h["default"].classes.hidden),setTimeout(function(){e.remove(),t(e)},h["default"].animation.timeout)}function c(e,t,n){var r=e?"add":"remove";t.classList[r](n)}function f(e,t){for(var n=w["default"].getListID(),r=t.target;r!==e;){if("LI"===r.nodeName)return t.preventDefault(),void(0,v.dispatch)({type:_["default"].ITEM_USER_IS_EDITING,listID:n,itemID:r.id});r=r.parentNode}}function d(e){var t=e.target;if("BUTTON"===t.nodeName&&t.parentNode.id){e.stopPropagation();var n=t.parentNode.id,r=!1;t.className===h["default"].classes.button["delete"]&&(r=_["default"].ITEM_DELETE),t.className===h["default"].classes.button.complete&&(r=_["default"].ITEM_MARK_COMPLETE),
r&&(0,v.dispatch)({type:r,itemID:n})}}var p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var m=n(10),h=r(m),g=n(7),_=r(g),v=n(8),b=n(73),y=(r(b),n(75)),E=r(y),I=n(16),w=r(I),S=n(9),x=r(S),T=new x["default"]("blocks/list"),k=function(){function e(){i(this,e),this.$list=document.querySelector(".items__list");var t=this.handleListChange.bind(this);E["default"].on(_["default"].STORE_UPDATED,t),w["default"].on(_["default"].STORE_UPDATED,t),w["default"].peerOn(_["default"].SERVER_LIST_PEER_UPDATED,function(e){(0,v.dispatch)({type:_["default"].SERVER_LIST_PEER_UPDATED,list:e})}),w["default"].peerOn(_["default"].SERVER_LIST_LOADED,function(e){(0,v.dispatch)({type:_["default"].SERVER_LIST_PEER_UPDATED,list:e})}),w["default"].peerOn(_["default"].SERVER_LIST_NOT_FOUND,function(e){T.log(_["default"].SERVER_LIST_NOT_FOUND+":",e),T.log("Redirecting to the home page..."),document.location.href="./"}),this.$list.addEventListener("dblclick",f.bind(null,this.$list)),this.$list.addEventListener("click",d)}return p(e,[{key:"handleListChange",value:function(){var e=this,t=w["default"].getAllItems(),n=this.$list.querySelectorAll("li"),r={};Object.keys(n).forEach(function(e){r[n[e].id]=n[e]}),T.log(t),"size"in t?(E["default"].getState().get("isListLoaded")?this.$list.classList.remove("items__list--loading"):(0,v.dispatch)({type:_["default"].LIST_HIDE_LOADING_STATUS}),t.forEach(function(t){delete r[t.id],o(e.$list,t)}),T.maybeLog(r.length>0,"itemsToRemove after rendering",r),Object.keys(r).forEach(function(e){l(r[e])})):T.log("No items in this list.")}}]),e}(),O=new k;t["default"]=O}]);